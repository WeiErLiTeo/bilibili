{
  "_comment": "Flutter 开发用 Dev Container 配置。放置于 .devcontainer/devcontainer.json。请确保同目录存在 Dockerfile，用于构建镜像。",
  "name": "Flutter Dev Container",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "remoteUser": "vscode",
  "containerEnv": {
    "_comment": "调整下面路径以匹配你 Dockerfile 中 Flutter 的安装位置",
    "PUB_CACHE": "/workspaces/.pub-cache",
    "FLUTTER_HOME": "/usr/local/flutter",
    "PATH": "/usr/local/flutter/bin:/usr/local/flutter/bin/cache/dart-sdk/bin:${PATH}"
  },
  "forwardPorts": [8080],
  "settings": {
    "_comment": "容器内 VS Code 设置",
    "terminal.integrated.shell.linux": "/bin/bash",
    "files.watcherExclude": {
      "**/.pub-cache/**": true,
      "**/.dart_tool/**": true
    }
  },
  "postCreateCommand": "bash -lc 'set -e; git config --global --add safe.directory \"$(pwd)\" || true; git config --global --add safe.directory /usr/local/flutter || true; flutter doctor -v'",
  "postStartCommand": "bash -lc 'set -e; if [ -f pubspec.yaml ]; then flutter pub get || true; fi'",
  "shutdownAction": "stopContainer",
  "customizations": {
    "vscode": {
      "extensions": [
        "Dart-Code.dart-code",
        "Dart-Code.flutter"
      ],
      "settings": {
        "dart.sdkPath": "/usr/local/flutter/bin/cache/dart-sdk",
        "dart.flutterSdkPath": "/usr/local/flutter"
      }
    }
  },
  "_comment_additional": "如果你的 Dockerfile 将 Flutter 安装到其他路径，请把 FLUTTER_HOME、PATH 和 dart.flutterSdkPath/dart.sdkPath 同步修改。"
}
